#include<reg52.h>
#include <intrins.h>
#define uchar unsigned char
#define uint unsigned int
sbit led1=P2^0; 
uchar SerialValue;			//???????;
uchar i;

void main()
{
	
	//----- Serial Port Setting -----
	TMOD=0x21;	//????????2 ??????????
	SM0=0;		//????????1  10??????  8???
	SM1=1;		//????????1  10??????  8???
	TH1=0xfd;	//????
	TL1=0xfd;	//????
	PCON=0x00;	//????????
	REN=1;		//????????REN=1,??????;REN=0,?????
	IP=0x10;
	TH0=(65535-50000)/256;
	TL0=(65535-50000)%256;

	TR0=1;		//??T0???/???
	ET0=1;		//T0???????;(?)

	TR1=1;		//??T1???/???
	ET1=1;		//T1???????;(?)
	ES=1;		//??????;(?)
	EA=1;		//?????;(?)
	SerialValue=0x02;
	while(1)
	{

	}
}
//????
void serial() interrupt 4
{
	SerialValue=SBUF;
  	RI=0;	
	if(SerialValue==1){led1=0;}
}

void timer0() interrupt 1
{	
	TH0=(65535-50000)/256;
	TL0=(65535-50000)%256;
	i++;
	if(i>SerialValue)
	{
		i=0;
		led1=!led1;
	}
}
